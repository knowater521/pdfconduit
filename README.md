# PDF Watermarker

A PDF tool for adding dynamically generated watermarks to PDF documents.

## Getting Started

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes. See deployment for notes on how to deploy the project on a live system.

### Prerequisites

In order to run this application you will need to have a Python 3 interpreter installed.  An excecutable is in developement that will avoid this step.

Upgrade to the latest version of pip.

```
pip install --upgrade pip
```

### Installation

Install the latest version from the PyPi distribution.  Run pip install databasetools on the command line of your interpreter (virtual environment not required but recommended).

PyPi distribution

```
pip install pdfwatermarker
```

## Purpose

PDFWatermarker was developed to streamline the redundant process of adding a watermark to PDF files before distribution to clients.

#### Process "as is"
 
1. Photoshop
	* Open watermark PSD template
	* Modify text (address, town, state)
	* Save file to PNG
2. Acrobat
	* Open source PDF file
	* Find PNG file and add as a watermark
	* Save new file with '_watermarked' suffix

#### Process "automated"

1. Run pdfwatermark GUI
2. Select source PDF file
3. Input text (address, town, state)

By removing the steps of launching Photoshop and Acrobat to perform a number of tasks process efficiency is dramatically increaded.

## Usage

Outlined below are basic uses of the main classes and functions of the PDF watermarker python package.

* WatermarkGUI - GUI for setting source file and watermark parameters
	* Launch GUI window to set source file and watermark settings
	* Dependent on PySimpleGUI library and TKinter back-end
	* Return inputs to caller
* Watermark - Wrapper class that manages inputs and file structures
	* Runs WatermarkDraw to generate watermark file
	* Runs WatermarkAdd to merge watermark and source file
	* Saves new watermark and removes temp files
* WatermarkDraw - Dynamically generates a watermark based on input text using a watermark template
	* Finds default watermark template and default font/opacity settings (font='Vera' and opacity=10%)
	* Creates letter sized Canvas using reportlab library
	* 'Draws' text to canvas at a 30 degree rotation and saves canvas object
	* Merges watermark template and dynamically drawn canvas to create watermark
	* Write watermark pdf file to temp folder and returns path
* WatermarkAdd - Merges source PDF file with the watermark generated by WatermarkDraw
	* Checks if source PDF file is verically or horizontally oriented
	* Calls upscale() to upscale PDF to fit letter size (8.5 x 11)
	* Checks if watermark orientation is the same as source pdf file's
		* Calls rotate() function to rotate watermark by increments of 90 degrees if needed
	* Merges source PDF file and watermark file to create new PDF object
* rotate() - Rotate PDF by increments of 90 degrees
* upscale() - Upscales PDF to fit letter size

## Challenges

* A number of PDF libraries exist I was unable to find one with the functionality I was looking for.
* Simple add watermark functionality wasn't enough, I needed the ability to adjust each watermark without opening another application.
* PDF files can only be rotated by 90 degree increments so slanted text was achieved by drawing to a rotated canvas object

## Built With

* [pdfrw](https://github.com/pmaupin/pdfrw) - pdfrw is a pure Python library that reads and writes PDFs.
* [Pillow](https://python-pillow.org/) - The friendly PIL fork (Python Imaging Library) 
* [PyPDF2](https://github.com/mstamy2/PyPDF2) - A utility to read and write PDFs with Python
* [PySimpleGUI](https://github.com/MikeTheWatchGuy/PySimpleGUI) - A simple yet powerful GUI built on top of tkinter.
* [reportlab](https://bitbucket.org/rptlab/reportlab) - Allows rapid creation of rich PDF documents, and also creation of charts in a variety of bitmap and vector formats.

## Contributing

Please read [CONTRIBUTING.md](https://github.com/mrstephenneal/databasetools/contributing.md) for details on our code of
 conduct, and the process for submitting pull requests to us.

## Versioning

We use [SemVer](http://semver.org/) for versioning. For the versions available, see the [tags on this repository](https://github.com/mrstephenneal/databasetools).

## Authors

* **Stephen Neal** - *Initial work* - [pdfwatermarker](https://github.com/mrstephenneal/pdfwatermarker)
